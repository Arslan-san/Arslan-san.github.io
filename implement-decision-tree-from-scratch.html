<!DOCTYPE html>
<html lang="en">

<head>
      <meta charset="utf-8">
  <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />


  <title>Decision Trees</title>


  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="referrer" content="origin" />
  <meta name="generator" content="Pelican" />
  <link href="https://arslan-san.github.io" rel="canonical" />

  <!-- Feed -->

  <link href="https://arslan-san.github.io/theme/css/style.css" type="text/css" rel="stylesheet" />

  <!-- Code highlight color scheme -->
      <link href="https://arslan-san.github.io/theme/css/code_blocks/github.css" rel="stylesheet">


  <!-- Custom fonts -->
  <link href='https://fonts.googleapis.com/css?family=Montserrat:400,300' rel='stylesheet' type='text/css' />
  <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet" type="text/css" />

  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
  <![endif]-->


    <link href="https://arslan-san.github.io/implement-decision-tree-from-scratch.html" rel="canonical" />

        <meta name="description" content="Implementing binary decision trees from scratch.">

        <meta name="author" content="Arslan">

        <meta name="tags" content="python linear-classifier decision-tree">

        <meta property="og:locale" content="" />
    <meta property="og:site_name" content="Arslan's Blog" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Arslan's Blog" />
    <meta property="og:description" content="View the blog." />
    <meta property="og:url" content="https://arslan-san.github.io" />
      <meta name="og:image" content="https://arslan-san.github.io/theme/images/post-bg.jpg">

  <meta property="og:type" content="article">
            <meta property="article:author" content="https://arslan-san.github.io/author/arslan.html">
  <meta property="og:url" content="https://arslan-san.github.io/implement-decision-tree-from-scratch.html">
  <meta property="og:title" content="Decision Trees">
  <meta property="article:published_time" content="2019-03-02 00:00:00-08:00">
            <meta property="og:description" content="Implementing binary decision trees from scratch.">

            <meta property="og:image" content="https://arslan-san.github.io/theme/images/post-bg.jpg">
</head>
<!-- TODO : Body class -->
<body class="home-template">

<nav id="menu">
  <a class="close-button">Close</a>
  <div class="nav-wrapper">
    <p class="nav-label">Menu</p>
    <ul>
          <li><a href="/pages/about.html" role="presentation">About</a></li>
          <li><a href="/pages/useful-resources.html" role="presentation">Useful Resources</a></li>
          <li><a href="/pages/completed-coursera-courses.html" role="presentation">Completed Coursera Courses</a></li>
          <li><a href="/pages/useful-ipython-notebooks.html" role="presentation">Useful Ipython Notebooks</a></li>

                  <li class="nav-posts active" role="presentation"><a href="https://arslan-san.github.io/category/posts.html">posts</a></li>

    </ul>
  </div>
</nav>
    <!-- Progressbar -->
    <div class="progress-container">
        <span class="progress-bar"></span>
    </div>

    <!-- Page Header -->
    <!-- Set your background image for this header on the line below. -->
    <header id="post-header" class="has-cover">
      <div class="inner">
        <nav id="navigation">
            <span id="home-button" class="nav-button">
                <a class="home-button" href = "../" href="https://arslan-san.github.io" title="Home"><i class="ic ic-arrow-left"></i> Home</a>
            </span>
          <span id="menu-button" class="nav-button">
            <a class="menu-button"><i class="ic ic-menu"></i> Menu</a>
          </span>
        </nav>
        <h1 class="post-title">Decision Trees</h1>
        <!-- TODO : Proper class for headline -->
        <span class="post-meta">
                <a href="https://arslan-san.github.io/author/arslan.html">Arslan</a>
            | <time datetime="Sat 02 March 2019">Sat 02 March 2019</time>
        </span>
        <!-- TODO : Modified check -->
        
            <div class="post-cover cover" style="background-image: url('https://arslan-san.github.io/theme/images/post-bg.jpg')">
        
      </div>
    </header>    

  <section id="wrapper">
    <a class="hidden-close"></a>

    <!-- Post content -->
    <main class="content" role="main">
        <article class="post">
        <div class="inner">
            <section class="post-content">
                <style type="text/css">/*!
*
* IPython notebook
*
*/
/* CSS font colors for translated ANSI escape sequences */
/* The color values are a mix of
   http://www.xcolors.net/dl/baskerville-ivorylight and
   http://www.xcolors.net/dl/euphrasia */
.ansi-black-fg {
  color: #3E424D;
}
.ansi-black-bg {
  background-color: #3E424D;
}
.ansi-black-intense-fg {
  color: #282C36;
}
.ansi-black-intense-bg {
  background-color: #282C36;
}
.ansi-red-fg {
  color: #E75C58;
}
.ansi-red-bg {
  background-color: #E75C58;
}
.ansi-red-intense-fg {
  color: #B22B31;
}
.ansi-red-intense-bg {
  background-color: #B22B31;
}
.ansi-green-fg {
  color: #00A250;
}
.ansi-green-bg {
  background-color: #00A250;
}
.ansi-green-intense-fg {
  color: #007427;
}
.ansi-green-intense-bg {
  background-color: #007427;
}
.ansi-yellow-fg {
  color: #DDB62B;
}
.ansi-yellow-bg {
  background-color: #DDB62B;
}
.ansi-yellow-intense-fg {
  color: #B27D12;
}
.ansi-yellow-intense-bg {
  background-color: #B27D12;
}
.ansi-blue-fg {
  color: #208FFB;
}
.ansi-blue-bg {
  background-color: #208FFB;
}
.ansi-blue-intense-fg {
  color: #0065CA;
}
.ansi-blue-intense-bg {
  background-color: #0065CA;
}
.ansi-magenta-fg {
  color: #D160C4;
}
.ansi-magenta-bg {
  background-color: #D160C4;
}
.ansi-magenta-intense-fg {
  color: #A03196;
}
.ansi-magenta-intense-bg {
  background-color: #A03196;
}
.ansi-cyan-fg {
  color: #60C6C8;
}
.ansi-cyan-bg {
  background-color: #60C6C8;
}
.ansi-cyan-intense-fg {
  color: #258F8F;
}
.ansi-cyan-intense-bg {
  background-color: #258F8F;
}
.ansi-white-fg {
  color: #C5C1B4;
}
.ansi-white-bg {
  background-color: #C5C1B4;
}
.ansi-white-intense-fg {
  color: #A1A6B2;
}
.ansi-white-intense-bg {
  background-color: #A1A6B2;
}
.ansi-default-inverse-fg {
  color: #FFFFFF;
}
.ansi-default-inverse-bg {
  background-color: #000000;
}
.ansi-bold {
  font-weight: bold;
}
.ansi-underline {
  text-decoration: underline;
}
/* The following styles are deprecated an will be removed in a future version */
.ansibold {
  font-weight: bold;
}
.ansi-inverse {
  outline: 0.5px dotted;
}
/* use dark versions for foreground, to improve visibility */
.ansiblack {
  color: black;
}
.ansired {
  color: darkred;
}
.ansigreen {
  color: darkgreen;
}
.ansiyellow {
  color: #c4a000;
}
.ansiblue {
  color: darkblue;
}
.ansipurple {
  color: darkviolet;
}
.ansicyan {
  color: steelblue;
}
.ansigray {
  color: gray;
}
/* and light for background, for the same reason */
.ansibgblack {
  background-color: black;
}
.ansibgred {
  background-color: red;
}
.ansibggreen {
  background-color: green;
}
.ansibgyellow {
  background-color: yellow;
}
.ansibgblue {
  background-color: blue;
}
.ansibgpurple {
  background-color: magenta;
}
.ansibgcyan {
  background-color: cyan;
}
.ansibggray {
  background-color: gray;
}
div.cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  border-radius: 2px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  border-width: 1px;
  border-style: solid;
  border-color: transparent;
  width: 100%;
  padding: 5px;
  /* This acts as a spacer between cells, that is outside the border */
  margin: 0px;
  outline: none;
  position: relative;
  overflow: visible;
}
div.cell:before {
  position: absolute;
  display: block;
  top: -1px;
  left: -1px;
  width: 5px;
  height: calc(100% +  2px);
  content: '';
  background: transparent;
}
div.cell.jupyter-soft-selected {
  border-left-color: #E3F2FD;
  border-left-width: 1px;
  padding-left: 5px;
  border-right-color: #E3F2FD;
  border-right-width: 1px;
  background: #E3F2FD;
}
@media print {
  div.cell.jupyter-soft-selected {
    border-color: transparent;
  }
}
div.cell.selected,
div.cell.selected.jupyter-soft-selected {
  border-color: #ababab;
}
div.cell.selected:before,
div.cell.selected.jupyter-soft-selected:before {
  position: absolute;
  display: block;
  top: -1px;
  left: -1px;
  width: 5px;
  height: calc(100% +  2px);
  content: '';
  background: #42A5F5;
}
@media print {
  div.cell.selected,
  div.cell.selected.jupyter-soft-selected {
    border-color: transparent;
  }
}
.edit_mode div.cell.selected {
  border-color: #66BB6A;
}
.edit_mode div.cell.selected:before {
  position: absolute;
  display: block;
  top: -1px;
  left: -1px;
  width: 5px;
  height: calc(100% +  2px);
  content: '';
  background: #66BB6A;
}
@media print {
  .edit_mode div.cell.selected {
    border-color: transparent;
  }
}
.prompt {
  /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */
  min-width: 14ex;
  /* This padding is tuned to match the padding on the CodeMirror editor. */
  padding: 0.4em;
  margin: 0px;
  font-family: monospace;
  text-align: right;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
  /* Don't highlight prompt number selection */
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  /* Use default cursor */
  cursor: default;
}
@media (max-width: 540px) {
  .prompt {
    text-align: left;
  }
}
div.inner_cell {
  min-width: 0;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_area {
  border: 1px solid #cfcfcf;
  border-radius: 2px;
  background: #f7f7f7;
  line-height: 1.21429em;
}
/* This is needed so that empty prompt areas can collapse to zero height when there
   is no content in the output_subarea and the prompt. The main purpose of this is
   to make sure that empty JavaScript output_subareas have no height. */
div.prompt:empty {
  padding-top: 0;
  padding-bottom: 0;
}
div.unrecognized_cell {
  padding: 5px 5px 5px 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.unrecognized_cell .inner_cell {
  border-radius: 2px;
  padding: 5px;
  font-weight: bold;
  color: red;
  border: 1px solid #cfcfcf;
  background: #eaeaea;
}
div.unrecognized_cell .inner_cell a {
  color: inherit;
  text-decoration: none;
}
div.unrecognized_cell .inner_cell a:hover {
  color: inherit;
  text-decoration: none;
}
@media (max-width: 540px) {
  div.unrecognized_cell > div.prompt {
    display: none;
  }
}
div.code_cell {
  /* avoid page breaking on code cells when printing */
}
@media print {
  div.code_cell {
    page-break-inside: avoid;
  }
}
/* any special styling for code cells that are currently running goes here */
div.input {
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.input {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_prompt {
  color: #303F9F;
  border-top: 1px solid transparent;
}
div.input_area > div.highlight {
  margin: 0.4em;
  border: none;
  padding: 0px;
  background-color: transparent;
}
div.input_area > div.highlight > pre {
  margin: 0px;
  border: none;
  padding: 0px;
  background-color: transparent;
}
/* The following gets added to the <head> if it is detected that the user has a
 * monospace font with inconsistent normal/bold/italic height.  See
 * notebookmain.js.  Such fonts will have keywords vertically offset with
 * respect to the rest of the text.  The user should select a better font.
 * See: https://github.com/ipython/ipython/issues/1503
 *
 * .CodeMirror span {
 *      vertical-align: bottom;
 * }
 */
.CodeMirror {
  line-height: 1.21429em;
  /* Changed from 1em to our global default */
  font-size: 14px;
  height: auto;
  /* Changed to auto to autogrow */
  background: none;
  /* Changed from white to allow our bg to show through */
}
.CodeMirror-scroll {
  /*  The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/
  /*  We have found that if it is visible, vertical scrollbars appear with font size changes.*/
  overflow-y: hidden;
  overflow-x: auto;
}
.CodeMirror-lines {
  /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */
  /* we have set a different line-height and want this to scale with that. */
  /* Note that this should set vertical padding only, since CodeMirror assumes
       that horizontal padding will be set on CodeMirror pre */
  padding: 0.4em 0;
}
.CodeMirror-linenumber {
  padding: 0 8px 0 4px;
}
.CodeMirror-gutters {
  border-bottom-left-radius: 2px;
  border-top-left-radius: 2px;
}
.CodeMirror pre {
  /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only,
    use .CodeMirror-lines for vertical */
  padding: 0 0.4em;
  border: 0;
  border-radius: 0;
}
.CodeMirror-cursor {
  border-left: 1.4px solid black;
}
@media screen and (min-width: 2138px) and (max-width: 4319px) {
  .CodeMirror-cursor {
    border-left: 2px solid black;
  }
}
@media screen and (min-width: 4320px) {
  .CodeMirror-cursor {
    border-left: 4px solid black;
  }
}
/*

Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org>
Adapted from GitHub theme

*/
.highlight-base {
  color: #000;
}
.highlight-variable {
  color: #000;
}
.highlight-variable-2 {
  color: #1a1a1a;
}
.highlight-variable-3 {
  color: #333333;
}
.highlight-string {
  color: #BA2121;
}
.highlight-comment {
  color: #408080;
  font-style: italic;
}
.highlight-number {
  color: #080;
}
.highlight-atom {
  color: #88F;
}
.highlight-keyword {
  color: #008000;
  font-weight: bold;
}
.highlight-builtin {
  color: #008000;
}
.highlight-error {
  color: #f00;
}
.highlight-operator {
  color: #AA22FF;
  font-weight: bold;
}
.highlight-meta {
  color: #AA22FF;
}
/* previously not defined, copying from default codemirror */
.highlight-def {
  color: #00f;
}
.highlight-string-2 {
  color: #f50;
}
.highlight-qualifier {
  color: #555;
}
.highlight-bracket {
  color: #997;
}
.highlight-tag {
  color: #170;
}
.highlight-attribute {
  color: #00c;
}
.highlight-header {
  color: blue;
}
.highlight-quote {
  color: #090;
}
.highlight-link {
  color: #00c;
}
/* apply the same style to codemirror */
.cm-s-ipython span.cm-keyword {
  color: #008000;
  font-weight: bold;
}
.cm-s-ipython span.cm-atom {
  color: #88F;
}
.cm-s-ipython span.cm-number {
  color: #080;
}
.cm-s-ipython span.cm-def {
  color: #00f;
}
.cm-s-ipython span.cm-variable {
  color: #000;
}
.cm-s-ipython span.cm-operator {
  color: #AA22FF;
  font-weight: bold;
}
.cm-s-ipython span.cm-variable-2 {
  color: #1a1a1a;
}
.cm-s-ipython span.cm-variable-3 {
  color: #333333;
}
.cm-s-ipython span.cm-comment {
  color: #408080;
  font-style: italic;
}
.cm-s-ipython span.cm-string {
  color: #BA2121;
}
.cm-s-ipython span.cm-string-2 {
  color: #f50;
}
.cm-s-ipython span.cm-meta {
  color: #AA22FF;
}
.cm-s-ipython span.cm-qualifier {
  color: #555;
}
.cm-s-ipython span.cm-builtin {
  color: #008000;
}
.cm-s-ipython span.cm-bracket {
  color: #997;
}
.cm-s-ipython span.cm-tag {
  color: #170;
}
.cm-s-ipython span.cm-attribute {
  color: #00c;
}
.cm-s-ipython span.cm-header {
  color: blue;
}
.cm-s-ipython span.cm-quote {
  color: #090;
}
.cm-s-ipython span.cm-link {
  color: #00c;
}
.cm-s-ipython span.cm-error {
  color: #f00;
}
.cm-s-ipython span.cm-tab {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=);
  background-position: right;
  background-repeat: no-repeat;
}
div.output_wrapper {
  /* this position must be relative to enable descendents to be absolute within it */
  position: relative;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  z-index: 1;
}
/* class for the output area when it should be height-limited */
div.output_scroll {
  /* ideally, this would be max-height, but FF barfs all over that */
  height: 24em;
  /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */
  width: 100%;
  overflow: auto;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  display: block;
}
/* output div while it is collapsed */
div.output_collapsed {
  margin: 0px;
  padding: 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
div.out_prompt_overlay {
  height: 100%;
  padding: 0px 0.4em;
  position: absolute;
  border-radius: 2px;
}
div.out_prompt_overlay:hover {
  /* use inner shadow to get border that is computed the same on WebKit/FF */
  -webkit-box-shadow: inset 0 0 1px #000;
  box-shadow: inset 0 0 1px #000;
  background: rgba(240, 240, 240, 0.5);
}
div.output_prompt {
  color: #D84315;
}
/* This class is the outer container of all output sections. */
div.output_area {
  padding: 0px;
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.output_area .MathJax_Display {
  text-align: left !important;
}
div.output_area 
div.output_area 
div.output_area img,
div.output_area svg {
  max-width: 100%;
  height: auto;
}
div.output_area img.unconfined,
div.output_area svg.unconfined {
  max-width: none;
}
div.output_area .mglyph > img {
  max-width: none;
}
/* This is needed to protect the pre formating from global settings such
   as that of bootstrap */
.output {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.output_area {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
div.output_area pre {
  margin: 0;
  padding: 1px 0 1px 0;
  border: 0;
  vertical-align: baseline;
  color: black;
  background-color: transparent;
  border-radius: 0;
}
/* This class is for the output subarea inside the output_area and after
   the prompt div. */
div.output_subarea {
  overflow-x: auto;
  padding: 0.4em;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
  max-width: calc(100% - 14ex);
}
div.output_scroll div.output_subarea {
  overflow-x: visible;
}
/* The rest of the output_* classes are for special styling of the different
   output types */
/* all text output has this class: */
div.output_text {
  text-align: left;
  color: #000;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
}
/* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */
div.output_stderr {
  background: #fdd;
  /* very light red background for stderr */
}
div.output_latex {
  text-align: left;
}
/* Empty output_javascript divs should have no height */
div.output_javascript:empty {
  padding: 0;
}
.js-error {
  color: darkred;
}
/* raw_input styles */
div.raw_input_container {
  line-height: 1.21429em;
  padding-top: 5px;
}
pre.raw_input_prompt {
  /* nothing needed here. */
}
input.raw_input {
  font-family: monospace;
  font-size: inherit;
  color: inherit;
  width: auto;
  /* make sure input baseline aligns with prompt */
  vertical-align: baseline;
  /* padding + margin = 0.5em between prompt and cursor */
  padding: 0em 0.25em;
  margin: 0em 0.25em;
}
input.raw_input:focus {
  box-shadow: none;
}
p.p-space {
  margin-bottom: 10px;
}
div.output_unrecognized {
  padding: 5px;
  font-weight: bold;
  color: red;
}
div.output_unrecognized a {
  color: inherit;
  text-decoration: none;
}
div.output_unrecognized a:hover {
  color: inherit;
  text-decoration: none;
}
.rendered_html {
  color: #000;
  /* any extras will just be numbers: */
}



.rendered_html :link {
  text-decoration: underline;
}
.rendered_html :visited {
  text-decoration: underline;
}






.rendered_html h1:first-child {
  margin-top: 0.538em;
}
.rendered_html h2:first-child {
  margin-top: 0.636em;
}
.rendered_html h3:first-child {
  margin-top: 0.777em;
}
.rendered_html h4:first-child {
  margin-top: 1em;
}
.rendered_html h5:first-child {
  margin-top: 1em;
}
.rendered_html h6:first-child {
  margin-top: 1em;
}
.rendered_html ul:not(.list-inline),
.rendered_html ol:not(.list-inline) {
  padding-left: 2em;
}








.rendered_html * + ul {
  margin-top: 1em;
}
.rendered_html * + ol {
  margin-top: 1em;
}





.rendered_html pre,




.rendered_html tr,
.rendered_html th,


.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
.rendered_html * + table {
  margin-top: 1em;
}

.rendered_html * + p {
  margin-top: 1em;
}

.rendered_html * + img {
  margin-top: 1em;
}
.rendered_html img,

.rendered_html img.unconfined,


.rendered_html * + .alert {
  margin-top: 1em;
}
[dir="rtl"] 
div.text_cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.text_cell > div.prompt {
    display: none;
  }
}
div.text_cell_render {
  /*font-family: "Helvetica Neue", Arial, Helvetica, Geneva, sans-serif;*/
  outline: none;
  resize: none;
  width: inherit;
  border-style: none;
  padding: 0.5em 0.5em 0.5em 0.4em;
  color: #000;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
a.anchor-link:link {
  text-decoration: none;
  padding: 0px 20px;
  visibility: hidden;
}
h1:hover .anchor-link,
h2:hover .anchor-link,
h3:hover .anchor-link,
h4:hover .anchor-link,
h5:hover .anchor-link,
h6:hover .anchor-link {
  visibility: visible;
}
.text_cell.rendered .input_area {
  display: none;
}
.text_cell.rendered 
.text_cell.rendered .rendered_html tr,
.text_cell.rendered .rendered_html th,
.text_cell.rendered 
.text_cell.unrendered .text_cell_render {
  display: none;
}
.text_cell .dropzone .input_area {
  border: 2px dashed #bababa;
  margin: -1px;
}
.cm-header-1,
.cm-header-2,
.cm-header-3,
.cm-header-4,
.cm-header-5,
.cm-header-6 {
  font-weight: bold;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
}
.cm-header-1 {
  font-size: 185.7%;
}
.cm-header-2 {
  font-size: 157.1%;
}
.cm-header-3 {
  font-size: 128.6%;
}
.cm-header-4 {
  font-size: 110%;
}
.cm-header-5 {
  font-size: 100%;
  font-style: italic;
}
.cm-header-6 {
  font-size: 100%;
  font-style: italic;
}
</style>
<style type="text/css">.highlight .hll { background-color: #ffffcc }
.highlight  { background: #f8f8f8; }
.highlight .c { color: #408080; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #7D9029 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #A0A000 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sa { color: #BA2121 } /* Literal.String.Affix */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0000FF } /* Name.Function.Magic */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .vm { color: #19177C } /* Name.Variable.Magic */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */</style>
<style type="text/css">
/* Temporary definitions which will become obsolete with Notebook release 5.0 */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-bold { font-weight: bold; }
</style>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Implementing-binary-decision-trees">Implementing binary decision trees<a class="anchor-link" href="#Implementing-binary-decision-trees">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The goal of this notebook is to implement your own binary decision tree classifier. You will:</p>
<ul>
<li>Use SFrames to do some feature engineering.</li>
<li>Transform categorical variables into binary variables.</li>
<li>Write a function to compute the number of misclassified examples in an intermediate node.</li>
<li>Write a function to find the best feature to split on.</li>
<li>Build a binary decision tree from scratch.</li>
<li>Make predictions using the decision tree.</li>
<li>Evaluate the accuracy of the decision tree.</li>
<li>Visualize the decision at the root node.</li>
</ul>
<p><strong>Important Note</strong>: In this assignment, we will focus on building decision trees where the data contain <strong>only binary (0 or 1) features</strong>. This allows us to avoid dealing with:</p>
<ul>
<li>Multiple intermediate nodes in a split</li>
<li>The thresholding issues of real-valued features.</li>
</ul>
<p>This assignment <strong>may be challenging</strong>, so brace yourself :)</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Fire-up-GraphLab-Create">Fire up GraphLab Create<a class="anchor-link" href="#Fire-up-GraphLab-Create">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Make sure you have the latest version of GraphLab Create.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="kn">import</span> <span class="nn">graphlab</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Load-the-lending-club-dataset">Load the lending club dataset<a class="anchor-link" href="#Load-the-lending-club-dataset">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We will be using the same <a href="https://www.lendingclub.com/">LendingClub</a> dataset as in the previous assignment.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">loans</span> <span class="o">=</span> <span class="n">graphlab</span><span class="o">.</span><span class="n">SFrame</span><span class="p">(</span><span class="s1">&#39;lending-club-data.gl/&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>This non-commercial license of GraphLab Create for academic use is assigned to arslanahmadid@gmail.com and will expire on October 28, 2019.
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stderr output_text">
<pre>[INFO] graphlab.cython.cy_server: GraphLab Create v2.0.1 started. Logging: C:\Users\arslan\AppData\Local\Temp\graphlab_server_1550319415.log.0
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Like the previous assignment, we reassign the labels to have +1 for a safe loan, and -1 for a risky (bad) loan.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">loans</span><span class="p">[</span><span class="s1">&#39;safe_loans&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">loans</span><span class="p">[</span><span class="s1">&#39;bad_loans&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="o">+</span><span class="mi">1</span> <span class="k">if</span> <span class="n">x</span><span class="o">==</span><span class="mi">0</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">loans</span> <span class="o">=</span> <span class="n">loans</span><span class="o">.</span><span class="n">remove_column</span><span class="p">(</span><span class="s1">&#39;bad_loans&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Unlike the previous assignment where we used several features, in this assignment, we will just be using 4 categorical
features:</p>
<ol>
<li>grade of the loan </li>
<li>the length of the loan term</li>
<li>the home ownership status: own, mortgage, rent</li>
<li>number of years of employment.</li>
</ol>
<p>Since we are building a binary decision tree, we will have to convert these categorical features to a binary representation in a subsequent section using 1-hot encoding.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">features</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;grade&#39;</span><span class="p">,</span>              <span class="c1"># grade of the loan</span>
            <span class="s1">&#39;term&#39;</span><span class="p">,</span>               <span class="c1"># the term of the loan</span>
            <span class="s1">&#39;home_ownership&#39;</span><span class="p">,</span>     <span class="c1"># home_ownership status: own, mortgage or rent</span>
            <span class="s1">&#39;emp_length&#39;</span><span class="p">,</span>         <span class="c1"># number of years of employment</span>
           <span class="p">]</span>
<span class="n">target</span> <span class="o">=</span> <span class="s1">&#39;safe_loans&#39;</span>
<span class="n">loans</span> <span class="o">=</span> <span class="n">loans</span><span class="p">[</span><span class="n">features</span> <span class="o">+</span> <span class="p">[</span><span class="n">target</span><span class="p">]]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's explore what the dataset looks like.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="k">print</span> <span class="n">loans</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>+-------+------------+----------------+------------+------------+
| grade |    term    | home_ownership | emp_length | safe_loans |
+-------+------------+----------------+------------+------------+
|   B   |  36 months |      RENT      | 10+ years  |     1      |
|   C   |  60 months |      RENT      |  &lt; 1 year  |     -1     |
|   C   |  36 months |      RENT      | 10+ years  |     1      |
|   C   |  36 months |      RENT      | 10+ years  |     1      |
|   A   |  36 months |      RENT      |  3 years   |     1      |
|   E   |  36 months |      RENT      |  9 years   |     1      |
|   F   |  60 months |      OWN       |  4 years   |     -1     |
|   B   |  60 months |      RENT      |  &lt; 1 year  |     -1     |
|   C   |  60 months |      OWN       |  5 years   |     1      |
|   B   |  36 months |      OWN       | 10+ years  |     1      |
+-------+------------+----------------+------------+------------+
[122607 rows x 5 columns]
Note: Only the head of the SFrame is printed.
You can use print_rows(num_rows=m, num_columns=n) to print more rows and columns.
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Subsample-dataset-to-make-sure-classes-are-balanced">Subsample dataset to make sure classes are balanced<a class="anchor-link" href="#Subsample-dataset-to-make-sure-classes-are-balanced">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Just as we did in the previous assignment, we will undersample the larger class (safe loans) in order to balance out our dataset. This means we are throwing away many data points. We use <code>seed=1</code> so everyone gets the same results.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[12]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">safe_loans_raw</span> <span class="o">=</span> <span class="n">loans</span><span class="p">[</span><span class="n">loans</span><span class="p">[</span><span class="n">target</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">risky_loans_raw</span> <span class="o">=</span> <span class="n">loans</span><span class="p">[</span><span class="n">loans</span><span class="p">[</span><span class="n">target</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># Since there are less risky loans than safe loans, find the ratio of the sizes</span>
<span class="c1"># and use that percentage to undersample the safe loans.</span>
<span class="n">percentage</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">risky_loans_raw</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">safe_loans_raw</span><span class="p">))</span>
<span class="n">safe_loans</span> <span class="o">=</span> <span class="n">safe_loans_raw</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">percentage</span><span class="p">,</span> <span class="n">seed</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">risky_loans</span> <span class="o">=</span> <span class="n">risky_loans_raw</span>
<span class="n">loans_data</span> <span class="o">=</span> <span class="n">risky_loans</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">safe_loans</span><span class="p">)</span>

<span class="k">print</span> <span class="s2">&quot;Percentage of safe loans                 :&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">safe_loans</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">loans_data</span><span class="p">))</span>
<span class="k">print</span> <span class="s2">&quot;Percentage of risky loans                :&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">risky_loans</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">loans_data</span><span class="p">))</span>
<span class="k">print</span> <span class="s2">&quot;Total number of loans in our new dataset :&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">loans_data</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Percentage of safe loans                 : 0.502236174422
Percentage of risky loans                : 0.497763825578
Total number of loans in our new dataset : 46508
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Note:</strong> There are many approaches for dealing with imbalanced data, including some where we modify the learning algorithm. These approaches are beyond the scope of this course, but some of them are reviewed in "<a href="http://www.ele.uri.edu/faculty/he/PDFfiles/ImbalancedLearning.pdf">Learning from Imbalanced Data</a>" by Haibo He and Edwardo A. Garcia, <em>IEEE Transactions on Knowledge and Data Engineering</em> <strong>21</strong>(9) (June 26, 2009), p. 1263â€“1284. For this assignment, we use the simplest possible approach, where we subsample the overly represented class to get a more balanced dataset. In general, and especially when the data is highly imbalanced, we recommend using more advanced methods.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Transform-categorical-data-into-binary-features">Transform categorical data into binary features<a class="anchor-link" href="#Transform-categorical-data-into-binary-features">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In this assignment, we will implement <strong>binary decision trees</strong> (decision trees for binary features, a specific case of categorical variables taking on two values, e.g., true/false). Since all of our features are currently categorical features, we want to turn them into binary features.</p>
<p>For instance, the <strong>home_ownership</strong> feature represents the home ownership status of the loanee, which is either <code>own</code>, <code>mortgage</code> or <code>rent</code>. For example, if a data point has the feature</p>

<pre><code>   {'home_ownership': 'RENT'}</code></pre>
<p>we want to turn this into three features:</p>

<pre><code> { 
   'home_ownership = OWN'      : 0, 
   'home_ownership = MORTGAGE' : 0, 
   'home_ownership = RENT'     : 1
 }</code></pre>
<p>Since this code requires a few Python and GraphLab tricks, feel free to use this block of code as is. Refer to the API documentation for a deeper understanding.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[13]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="k">print</span> <span class="n">loans_data</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>+-------+------------+----------------+------------+------------+
| grade |    term    | home_ownership | emp_length | safe_loans |
+-------+------------+----------------+------------+------------+
|   C   |  60 months |      RENT      |  &lt; 1 year  |     -1     |
|   F   |  60 months |      OWN       |  4 years   |     -1     |
|   B   |  60 months |      RENT      |  &lt; 1 year  |     -1     |
|   C   |  36 months |      RENT      |  &lt; 1 year  |     -1     |
|   B   |  36 months |      RENT      |  3 years   |     -1     |
|   B   |  36 months |      RENT      | 10+ years  |     -1     |
|   B   |  36 months |      RENT      |   1 year   |     -1     |
|   C   |  36 months |      RENT      |  9 years   |     -1     |
|   D   |  60 months |      RENT      |  2 years   |     -1     |
|   A   |  36 months |    MORTGAGE    | 10+ years  |     -1     |
+-------+------------+----------------+------------+------------+
[46508 rows x 5 columns]
Note: Only the head of the SFrame is printed.
You can use print_rows(num_rows=m, num_columns=n) to print more rows and columns.
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[15]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">loans_data</span> <span class="o">=</span> <span class="n">risky_loans</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">safe_loans</span><span class="p">)</span>
<span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="n">features</span><span class="p">:</span>
    <span class="n">loans_data_one_hot_encoded</span> <span class="o">=</span> <span class="n">loans_data</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">{</span><span class="n">x</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>    
    <span class="n">loans_data_unpacked</span> <span class="o">=</span> <span class="n">loans_data_one_hot_encoded</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">column_name_prefix</span><span class="o">=</span><span class="n">feature</span><span class="p">)</span>
    
    <span class="c1"># Change None&#39;s to 0&#39;s</span>
    <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">loans_data_unpacked</span><span class="o">.</span><span class="n">column_names</span><span class="p">():</span>
        <span class="n">loans_data_unpacked</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="n">loans_data_unpacked</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">loans_data</span><span class="o">.</span><span class="n">remove_column</span><span class="p">(</span><span class="n">feature</span><span class="p">)</span>
    <span class="n">loans_data</span><span class="o">.</span><span class="n">add_columns</span><span class="p">(</span><span class="n">loans_data_unpacked</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[17]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="k">print</span> <span class="n">loans_data</span><span class="o">.</span><span class="n">column_names</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;bound method SFrame.column_names of Columns:
	safe_loans	int
	grade.A	int
	grade.B	int
	grade.C	int
	grade.D	int
	grade.E	int
	grade.F	int
	grade.G	int
	term. 36 months	int
	term. 60 months	int
	home_ownership.MORTGAGE	int
	home_ownership.OTHER	int
	home_ownership.OWN	int
	home_ownership.RENT	int
	emp_length.1 year	int
	emp_length.10+ years	int
	emp_length.2 years	int
	emp_length.3 years	int
	emp_length.4 years	int
	emp_length.5 years	int
	emp_length.6 years	int
	emp_length.7 years	int
	emp_length.8 years	int
	emp_length.9 years	int
	emp_length.&lt; 1 year	int
	emp_length.n/a	int

Rows: 46508

Data:
+------------+---------+---------+---------+---------+---------+---------+---------+
| safe_loans | grade.A | grade.B | grade.C | grade.D | grade.E | grade.F | grade.G |
+------------+---------+---------+---------+---------+---------+---------+---------+
|     -1     |    0    |    0    |    1    |    0    |    0    |    0    |    0    |
|     -1     |    0    |    0    |    0    |    0    |    0    |    1    |    0    |
|     -1     |    0    |    1    |    0    |    0    |    0    |    0    |    0    |
|     -1     |    0    |    0    |    1    |    0    |    0    |    0    |    0    |
|     -1     |    0    |    1    |    0    |    0    |    0    |    0    |    0    |
|     -1     |    0    |    1    |    0    |    0    |    0    |    0    |    0    |
|     -1     |    0    |    1    |    0    |    0    |    0    |    0    |    0    |
|     -1     |    0    |    0    |    1    |    0    |    0    |    0    |    0    |
|     -1     |    0    |    0    |    0    |    1    |    0    |    0    |    0    |
|     -1     |    1    |    0    |    0    |    0    |    0    |    0    |    0    |
+------------+---------+---------+---------+---------+---------+---------+---------+
+-----------------+-----------------+-------------------------+----------------------+
| term. 36 months | term. 60 months | home_ownership.MORTGAGE | home_ownership.OTHER |
+-----------------+-----------------+-------------------------+----------------------+
|        0        |        1        |            0            |          0           |
|        0        |        1        |            0            |          0           |
|        0        |        1        |            0            |          0           |
|        1        |        0        |            0            |          0           |
|        1        |        0        |            0            |          0           |
|        1        |        0        |            0            |          0           |
|        1        |        0        |            0            |          0           |
|        1        |        0        |            0            |          0           |
|        0        |        1        |            0            |          0           |
|        1        |        0        |            1            |          0           |
+-----------------+-----------------+-------------------------+----------------------+
+--------------------+---------------------+-------------------+----------------------+
| home_ownership.OWN | home_ownership.RENT | emp_length.1 year | emp_length.10+ years |
+--------------------+---------------------+-------------------+----------------------+
|         0          |          1          |         0         |          0           |
|         1          |          0          |         0         |          0           |
|         0          |          1          |         0         |          0           |
|         0          |          1          |         0         |          0           |
|         0          |          1          |         0         |          0           |
|         0          |          1          |         0         |          1           |
|         0          |          1          |         1         |          0           |
|         0          |          1          |         0         |          0           |
|         0          |          1          |         0         |          0           |
|         0          |          0          |         0         |          1           |
+--------------------+---------------------+-------------------+----------------------+
+--------------------+--------------------+--------------------+--------------------+-----+
| emp_length.2 years | emp_length.3 years | emp_length.4 years | emp_length.5 years | ... |
+--------------------+--------------------+--------------------+--------------------+-----+
|         0          |         0          |         0          |         0          | ... |
|         0          |         0          |         1          |         0          | ... |
|         0          |         0          |         0          |         0          | ... |
|         0          |         0          |         0          |         0          | ... |
|         0          |         1          |         0          |         0          | ... |
|         0          |         0          |         0          |         0          | ... |
|         0          |         0          |         0          |         0          | ... |
|         0          |         0          |         0          |         0          | ... |
|         1          |         0          |         0          |         0          | ... |
|         0          |         0          |         0          |         0          | ... |
+--------------------+--------------------+--------------------+--------------------+-----+
[46508 rows x 26 columns]
Note: Only the head of the SFrame is printed.
You can use print_rows(num_rows=m, num_columns=n) to print more rows and columns.&gt;
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[14]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="c1"># Just for checking that how one hot encoding done</span>

<span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="n">features</span><span class="p">:</span>
    <span class="n">loans_data_one_hot_encoded</span> <span class="o">=</span> <span class="n">loans_data</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">{</span><span class="n">x</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
    <span class="n">loans_data_unpacked</span> <span class="o">=</span> <span class="n">loans_data_one_hot_encoded</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">column_name_prefix</span><span class="o">=</span><span class="n">feature</span><span class="p">)</span>
    <span class="c1"># Change None&#39;s to 0&#39;s</span>

    <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">loans_data_unpacked</span><span class="o">.</span><span class="n">column_names</span><span class="p">():</span>
        <span class="n">loans_data_unpacked</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="n">loans_data_unpacked</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">loans_data</span><span class="o">.</span><span class="n">remove_column</span><span class="p">(</span><span class="n">feature</span><span class="p">)</span>
    <span class="n">loans_data</span><span class="o">.</span><span class="n">add_columns</span><span class="p">(</span><span class="n">loans_data_unpacked</span><span class="p">)</span>
    <span class="k">print</span> <span class="n">loans_data_one_hot_encoded</span>
    <span class="k">print</span> <span class="n">loans_data_unpacked</span>
    <span class="k">break</span>
<span class="k">print</span> <span class="n">loans_data</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>[{&#39;C&#39;: 1L}, {&#39;F&#39;: 1L}, {&#39;B&#39;: 1L}, {&#39;C&#39;: 1L}, {&#39;B&#39;: 1L}, {&#39;B&#39;: 1L}, {&#39;B&#39;: 1L}, {&#39;C&#39;: 1L}, {&#39;D&#39;: 1L}, {&#39;A&#39;: 1L}, {&#39;B&#39;: 1L}, {&#39;C&#39;: 1L}, {&#39;E&#39;: 1L}, {&#39;D&#39;: 1L}, {&#39;F&#39;: 1L}, {&#39;D&#39;: 1L}, {&#39;D&#39;: 1L}, {&#39;B&#39;: 1L}, {&#39;D&#39;: 1L}, {&#39;D&#39;: 1L}, {&#39;B&#39;: 1L}, {&#39;E&#39;: 1L}, {&#39;C&#39;: 1L}, {&#39;A&#39;: 1L}, {&#39;B&#39;: 1L}, {&#39;B&#39;: 1L}, {&#39;C&#39;: 1L}, {&#39;C&#39;: 1L}, {&#39;A&#39;: 1L}, {&#39;C&#39;: 1L}, {&#39;D&#39;: 1L}, {&#39;F&#39;: 1L}, {&#39;B&#39;: 1L}, {&#39;D&#39;: 1L}, {&#39;D&#39;: 1L}, {&#39;B&#39;: 1L}, {&#39;C&#39;: 1L}, {&#39;B&#39;: 1L}, {&#39;D&#39;: 1L}, {&#39;C&#39;: 1L}, {&#39;B&#39;: 1L}, {&#39;D&#39;: 1L}, {&#39;B&#39;: 1L}, {&#39;B&#39;: 1L}, {&#39;B&#39;: 1L}, {&#39;B&#39;: 1L}, {&#39;A&#39;: 1L}, {&#39;C&#39;: 1L}, {&#39;B&#39;: 1L}, {&#39;A&#39;: 1L}, {&#39;D&#39;: 1L}, {&#39;B&#39;: 1L}, {&#39;D&#39;: 1L}, {&#39;E&#39;: 1L}, {&#39;E&#39;: 1L}, {&#39;C&#39;: 1L}, {&#39;B&#39;: 1L}, {&#39;B&#39;: 1L}, {&#39;B&#39;: 1L}, {&#39;A&#39;: 1L}, {&#39;B&#39;: 1L}, {&#39;B&#39;: 1L}, {&#39;A&#39;: 1L}, {&#39;B&#39;: 1L}, {&#39;A&#39;: 1L}, {&#39;B&#39;: 1L}, {&#39;B&#39;: 1L}, {&#39;A&#39;: 1L}, {&#39;E&#39;: 1L}, {&#39;C&#39;: 1L}, {&#39;C&#39;: 1L}, {&#39;C&#39;: 1L}, {&#39;B&#39;: 1L}, {&#39;D&#39;: 1L}, {&#39;B&#39;: 1L}, {&#39;D&#39;: 1L}, {&#39;D&#39;: 1L}, {&#39;A&#39;: 1L}, {&#39;C&#39;: 1L}, {&#39;A&#39;: 1L}, {&#39;E&#39;: 1L}, {&#39;C&#39;: 1L}, {&#39;B&#39;: 1L}, {&#39;C&#39;: 1L}, {&#39;B&#39;: 1L}, {&#39;E&#39;: 1L}, {&#39;A&#39;: 1L}, {&#39;C&#39;: 1L}, {&#39;E&#39;: 1L}, {&#39;D&#39;: 1L}, {&#39;D&#39;: 1L}, {&#39;B&#39;: 1L}, {&#39;C&#39;: 1L}, {&#39;A&#39;: 1L}, {&#39;A&#39;: 1L}, {&#39;D&#39;: 1L}, {&#39;B&#39;: 1L}, {&#39;D&#39;: 1L}, {&#39;A&#39;: 1L}, {&#39;D&#39;: 1L}, ... ]
+---------+---------+---------+---------+---------+---------+---------+
| grade.A | grade.B | grade.C | grade.D | grade.E | grade.F | grade.G |
+---------+---------+---------+---------+---------+---------+---------+
|    0    |    0    |    1    |    0    |    0    |    0    |    0    |
|    0    |    0    |    0    |    0    |    0    |    1    |    0    |
|    0    |    1    |    0    |    0    |    0    |    0    |    0    |
|    0    |    0    |    1    |    0    |    0    |    0    |    0    |
|    0    |    1    |    0    |    0    |    0    |    0    |    0    |
|    0    |    1    |    0    |    0    |    0    |    0    |    0    |
|    0    |    1    |    0    |    0    |    0    |    0    |    0    |
|    0    |    0    |    1    |    0    |    0    |    0    |    0    |
|    0    |    0    |    0    |    1    |    0    |    0    |    0    |
|    1    |    0    |    0    |    0    |    0    |    0    |    0    |
+---------+---------+---------+---------+---------+---------+---------+
[46508 rows x 7 columns]
Note: Only the head of the SFrame is printed.
You can use print_rows(num_rows=m, num_columns=n) to print more rows and columns.
+------------+----------------+------------+------------+---------+---------+---------+
|    term    | home_ownership | emp_length | safe_loans | grade.A | grade.B | grade.C |
+------------+----------------+------------+------------+---------+---------+---------+
|  60 months |      RENT      |  &lt; 1 year  |     -1     |    0    |    0    |    1    |
|  60 months |      OWN       |  4 years   |     -1     |    0    |    0    |    0    |
|  60 months |      RENT      |  &lt; 1 year  |     -1     |    0    |    1    |    0    |
|  36 months |      RENT      |  &lt; 1 year  |     -1     |    0    |    0    |    1    |
|  36 months |      RENT      |  3 years   |     -1     |    0    |    1    |    0    |
|  36 months |      RENT      | 10+ years  |     -1     |    0    |    1    |    0    |
|  36 months |      RENT      |   1 year   |     -1     |    0    |    1    |    0    |
|  36 months |      RENT      |  9 years   |     -1     |    0    |    0    |    1    |
|  60 months |      RENT      |  2 years   |     -1     |    0    |    0    |    0    |
|  36 months |    MORTGAGE    | 10+ years  |     -1     |    1    |    0    |    0    |
+------------+----------------+------------+------------+---------+---------+---------+
+---------+---------+---------+---------+
| grade.D | grade.E | grade.F | grade.G |
+---------+---------+---------+---------+
|    0    |    0    |    0    |    0    |
|    0    |    0    |    1    |    0    |
|    0    |    0    |    0    |    0    |
|    0    |    0    |    0    |    0    |
|    0    |    0    |    0    |    0    |
|    0    |    0    |    0    |    0    |
|    0    |    0    |    0    |    0    |
|    0    |    0    |    0    |    0    |
|    1    |    0    |    0    |    0    |
|    0    |    0    |    0    |    0    |
+---------+---------+---------+---------+
[46508 rows x 11 columns]
Note: Only the head of the SFrame is printed.
You can use print_rows(num_rows=m, num_columns=n) to print more rows and columns.
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's see what the feature columns look like now:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[19]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">features</span> <span class="o">=</span> <span class="n">loans_data</span><span class="o">.</span><span class="n">column_names</span><span class="p">()</span>
<span class="n">features</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;safe_loans&#39;</span><span class="p">)</span>  <span class="c1"># Remove the response variable</span>
<span class="n">features</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[19]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>[&#39;grade.A&#39;,
 &#39;grade.B&#39;,
 &#39;grade.C&#39;,
 &#39;grade.D&#39;,
 &#39;grade.E&#39;,
 &#39;grade.F&#39;,
 &#39;grade.G&#39;,
 &#39;term. 36 months&#39;,
 &#39;term. 60 months&#39;,
 &#39;home_ownership.MORTGAGE&#39;,
 &#39;home_ownership.OTHER&#39;,
 &#39;home_ownership.OWN&#39;,
 &#39;home_ownership.RENT&#39;,
 &#39;emp_length.1 year&#39;,
 &#39;emp_length.10+ years&#39;,
 &#39;emp_length.2 years&#39;,
 &#39;emp_length.3 years&#39;,
 &#39;emp_length.4 years&#39;,
 &#39;emp_length.5 years&#39;,
 &#39;emp_length.6 years&#39;,
 &#39;emp_length.7 years&#39;,
 &#39;emp_length.8 years&#39;,
 &#39;emp_length.9 years&#39;,
 &#39;emp_length.&lt; 1 year&#39;,
 &#39;emp_length.n/a&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[20]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="k">print</span> <span class="s2">&quot;Number of features (after binarizing categorical variables) = </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Number of features (after binarizing categorical variables) = 25
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's explore what one of these columns looks like:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[21]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">loans_data</span><span class="p">[</span><span class="s1">&#39;grade.A&#39;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[21]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>dtype: int
Rows: 46508
[0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 1L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 1L, 0L, 0L, 0L, 0L, 1L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 1L, 0L, 0L, 1L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 1L, 0L, 0L, 1L, 0L, 1L, 0L, 0L, 1L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 0L, 1L, 0L, 1L, 0L, 0L, 0L, 0L, 0L, 0L, 1L, 0L, 0L, 0L, 0L, 0L, 0L, 1L, 1L, 0L, 0L, 0L, 1L, 0L, ... ]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This column is set to 1 if the loan grade is A and 0 otherwise.</p>
<p><strong>Checkpoint:</strong> Make sure the following answers match up.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[22]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="k">print</span> <span class="s2">&quot;Total number of grade.A loans : </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">loans_data</span><span class="p">[</span><span class="s1">&#39;grade.A&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="k">print</span> <span class="s2">&quot;Expexted answer               : 6422&quot;</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Total number of grade.A loans : 6422
Expexted answer               : 6422
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Train-test-split">Train-test split<a class="anchor-link" href="#Train-test-split">&#182;</a></h2><p>We split the data into a train test split with 80% of the data in the training set and 20% of the data in the test set. We use <code>seed=1</code> so that everyone gets the same result.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[23]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">train_data</span><span class="p">,</span> <span class="n">test_data</span> <span class="o">=</span> <span class="n">loans_data</span><span class="o">.</span><span class="n">random_split</span><span class="p">(</span><span class="o">.</span><span class="mi">8</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Decision-tree-implementation">Decision tree implementation<a class="anchor-link" href="#Decision-tree-implementation">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In this section, we will implement binary decision trees from scratch. There are several steps involved in building a decision tree. For that reason, we have split the entire assignment into several sections.</p>
<h2 id="Function-to-count-number-of-mistakes-while-predicting-majority-class">Function to count number of mistakes while predicting majority class<a class="anchor-link" href="#Function-to-count-number-of-mistakes-while-predicting-majority-class">&#182;</a></h2><p>Recall from the lecture that prediction at an intermediate node works by predicting the <strong>majority class</strong> for all data points that belong to this node.</p>
<p>Now, we will write a function that calculates the number of <strong>missclassified examples</strong> when predicting the <strong>majority class</strong>. This will be used to help determine which feature is the best to split on at a given node of the tree.</p>
<p><strong>Note</strong>: Keep in mind that in order to compute the number of mistakes for a majority classifier, we only need the label (y values) of the data points in the node.</p>
<p><strong> Steps to follow </strong>:</p>
<ul>
<li><strong> Step 1:</strong> Calculate the number of safe loans and risky loans.</li>
<li><strong> Step 2:</strong> Since we are assuming majority class prediction, all the data points that are <strong>not</strong> in the majority class are considered <strong>mistakes</strong>.</li>
<li><strong> Step 3:</strong> Return the number of <strong>mistakes</strong>.</li>
</ul>
<p>Now, let us write the function <code>intermediate_node_num_mistakes</code> which computes the number of misclassified examples of an intermediate node given the set of labels (y values) of the data points contained in the node. Fill in the places where you find <code>## YOUR CODE HERE</code>. There are <strong>three</strong> places in this function for you to fill in.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[43]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="k">def</span> <span class="nf">intermediate_node_num_mistakes</span><span class="p">(</span><span class="n">labels_in_node</span><span class="p">):</span>
    <span class="c1"># Corner case: If labels_in_node is empty, return 0</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">labels_in_node</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
    
    <span class="c1"># Count the number of 1&#39;s (safe loans)</span>
    <span class="c1">## YOUR CODE HERE</span>
    
    <span class="n">safe</span> <span class="o">=</span> <span class="p">(</span><span class="n">labels_in_node</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    
    <span class="c1"># Count the number of -1&#39;s (risky loans)</span>
    <span class="c1">## YOUR CODE HERE</span>
    
    <span class="n">bad</span> <span class="o">=</span> <span class="p">(</span><span class="n">labels_in_node</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
                
    <span class="c1"># Return the number of mistakes that the majority classifier makes.</span>
    <span class="c1">## YOUR CODE HERE</span>

    <span class="k">if</span> <span class="n">safe</span> <span class="o">&gt;</span> <span class="n">bad</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">bad</span>
    <span class="k">else</span><span class="p">:</span>
         <span class="k">return</span> <span class="n">safe</span>
    
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[47]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="k">print</span> <span class="n">graphlab</span><span class="o">.</span><span class="n">SArray</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="o">==</span> <span class="mi">1</span>

<span class="k">print</span> <span class="p">(</span><span class="n">graphlab</span><span class="o">.</span><span class="n">SArray</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="k">print</span> <span class="n">features</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>[0L, 0L, 1L, 1L, 1L]
3
[&#39;grade.A&#39;, &#39;grade.B&#39;, &#39;grade.C&#39;, &#39;grade.D&#39;, &#39;grade.E&#39;, &#39;grade.F&#39;, &#39;grade.G&#39;, &#39;term. 36 months&#39;, &#39;term. 60 months&#39;, &#39;home_ownership.MORTGAGE&#39;, &#39;home_ownership.OTHER&#39;, &#39;home_ownership.OWN&#39;, &#39;home_ownership.RENT&#39;, &#39;emp_length.1 year&#39;, &#39;emp_length.10+ years&#39;, &#39;emp_length.2 years&#39;, &#39;emp_length.3 years&#39;, &#39;emp_length.4 years&#39;, &#39;emp_length.5 years&#39;, &#39;emp_length.6 years&#39;, &#39;emp_length.7 years&#39;, &#39;emp_length.8 years&#39;, &#39;emp_length.9 years&#39;, &#39;emp_length.&lt; 1 year&#39;, &#39;emp_length.n/a&#39;]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Because there are several steps in this assignment, we have introduced some stopping points where you can check your code and make sure it is correct before proceeding. To test your <code>intermediate_node_num_mistakes</code> function, run the following code until you get a <strong>Test passed!</strong>, then you should proceed. Otherwise, you should spend some time figuring out where things went wrong.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[45]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="c1"># Test case 1</span>
<span class="n">example_labels</span> <span class="o">=</span> <span class="n">graphlab</span><span class="o">.</span><span class="n">SArray</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="k">if</span> <span class="n">intermediate_node_num_mistakes</span><span class="p">(</span><span class="n">example_labels</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
    <span class="k">print</span> <span class="s1">&#39;Test passed!&#39;</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">print</span> <span class="s1">&#39;Test 1 failed... try again!&#39;</span>

<span class="c1"># Test case 2</span>
<span class="n">example_labels</span> <span class="o">=</span> <span class="n">graphlab</span><span class="o">.</span><span class="n">SArray</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="k">if</span> <span class="n">intermediate_node_num_mistakes</span><span class="p">(</span><span class="n">example_labels</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
    <span class="k">print</span> <span class="s1">&#39;Test passed!&#39;</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">print</span> <span class="s1">&#39;Test 2 failed... try again!&#39;</span>
    
<span class="c1"># Test case 3</span>
<span class="n">example_labels</span> <span class="o">=</span> <span class="n">graphlab</span><span class="o">.</span><span class="n">SArray</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="k">if</span> <span class="n">intermediate_node_num_mistakes</span><span class="p">(</span><span class="n">example_labels</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
    <span class="k">print</span> <span class="s1">&#39;Test passed!&#39;</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">print</span> <span class="s1">&#39;Test 3 failed... try again!&#39;</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Test passed!
Test passed!
Test passed!
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Function-to-pick-best-feature-to-split-on">Function to pick best feature to split on<a class="anchor-link" href="#Function-to-pick-best-feature-to-split-on">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The function <strong>best_splitting_feature</strong> takes 3 arguments:</p>
<ol>
<li>The data (SFrame of data which includes all of the feature columns and label column)</li>
<li>The features to consider for splits (a list of strings of column names to consider for splits)</li>
<li>The name of the target/label column (string)</li>
</ol>
<p>The function will loop through the list of possible features, and consider splitting on each of them. It will calculate the classification error of each split and return the feature that had the smallest classification error when split on.</p>
<p>Recall that the <strong>classification error</strong> is defined as follows:
$$
\mbox{classification error} = \frac{\mbox{# mistakes}}{\mbox{# total examples}}
$$</p>
<p>Follow these steps:</p>
<ul>
<li><strong>Step 1:</strong> Loop over each feature in the feature list</li>
<li><strong>Step 2:</strong> Within the loop, split the data into two groups: one group where all of the data has feature value 0 or False (we will call this the <strong>left</strong> split), and one group where all of the data has feature value 1 or True (we will call this the <strong>right</strong> split). Make sure the <strong>left</strong> split corresponds with 0 and the <strong>right</strong> split corresponds with 1 to ensure your implementation fits with our implementation of the tree building process.</li>
<li><strong>Step 3:</strong> Calculate the number of misclassified examples in both groups of data and use the above formula to compute the <strong>classification error</strong>.</li>
<li><strong>Step 4:</strong> If the computed error is smaller than the best error found so far, store this <strong>feature and its error</strong>.</li>
</ul>
<p>This may seem like a lot, but we have provided pseudocode in the comments in order to help you implement the function correctly.</p>
<p><strong>Note:</strong> Remember that since we are only dealing with binary features, we do not have to consider thresholds for real-valued features. This makes the implementation of this function much easier.</p>
<p>Fill in the places where you find <code>## YOUR CODE HERE</code>. There are <strong>five</strong> places in this function for you to fill in.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[76]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="k">def</span> <span class="nf">best_splitting_feature</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
    
    <span class="n">best_feature</span> <span class="o">=</span> <span class="bp">None</span> <span class="c1"># Keep track of the best feature </span>
    <span class="n">best_error</span> <span class="o">=</span> <span class="mi">10</span>     <span class="c1"># Keep track of the best error so far </span>
    <span class="c1"># Note: Since error is always &lt;= 1, we should intialize it with something larger than 1.</span>

    <span class="c1"># Convert to float to make sure error gets computed correctly.</span>
    <span class="n">num_data_points</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>  
    
    <span class="c1"># Loop through each feature to consider splitting on that feature</span>
    <span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="n">features</span><span class="p">:</span>
        
        <span class="c1"># The left split will have all data points where the feature value is 0</span>
        <span class="n">left_split</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>
        
        <span class="c1"># The right split will have all data points where the feature value is 1</span>
        <span class="c1">## YOUR CODE HERE</span>
        <span class="n">right_split</span> <span class="o">=</span>  <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>
            
        <span class="c1"># Calculate the number of misclassified examples in the left split.</span>
        <span class="c1"># Remember that we implemented a function for this! (It was called intermediate_node_num_mistakes)</span>
        <span class="c1"># YOUR CODE HERE</span>
        <span class="n">left_mistakes</span> <span class="o">=</span> <span class="n">intermediate_node_num_mistakes</span><span class="p">(</span><span class="n">left_split</span><span class="p">[</span><span class="n">target</span><span class="p">])</span>
        

        <span class="c1"># Calculate the number of misclassified examples in the right split.</span>
        <span class="c1">## YOUR CODE HERE</span>
        <span class="n">right_mistakes</span> <span class="o">=</span> <span class="n">intermediate_node_num_mistakes</span><span class="p">(</span><span class="n">right_split</span><span class="p">[</span><span class="n">target</span><span class="p">])</span>
            
        <span class="c1"># Compute the classification error of this split.</span>
        <span class="c1"># Error = (# of mistakes (left) + # of mistakes (right)) / (# of data points)</span>
        <span class="c1">## YOUR CODE HERE</span>
        <span class="n">error</span> <span class="o">=</span> <span class="p">(</span><span class="n">left_mistakes</span> <span class="o">+</span> <span class="n">right_mistakes</span><span class="p">)</span> <span class="o">/</span> <span class="n">num_data_points</span>
        
        <span class="c1">#print &#39;feature: &#39;,feature, &#39;, left mistake: &#39;, left_mistakes, &#39;, right mistake: &#39;, right_mistakes, &#39;, error: &#39;, error</span>

        <span class="c1"># If this is the best error we have found so far, store the feature as best_feature and the error as best_error</span>
        <span class="c1">## YOUR CODE HERE</span>
        <span class="k">if</span> <span class="n">error</span> <span class="o">&lt;</span> <span class="n">best_error</span><span class="p">:</span>
            <span class="n">best_feature</span> <span class="o">=</span> <span class="n">feature</span>
            <span class="n">best_error</span> <span class="o">=</span> <span class="n">error</span>
        
    <span class="c1">#print &#39;Best error: &#39;, best_error</span>
    <span class="k">return</span> <span class="n">best_feature</span> <span class="c1"># Return the best feature we found</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To test your <code>best_splitting_feature</code> function, run the following code:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[66]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="k">if</span> <span class="n">best_splitting_feature</span><span class="p">(</span><span class="n">train_data</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="s1">&#39;safe_loans&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;term. 36 months&#39;</span><span class="p">:</span>
    <span class="k">print</span> <span class="s1">&#39;Test passed!&#39;</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">print</span> <span class="s1">&#39;Test failed... try again!&#39;</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>feature:  grade.A , left mistake:  14876 , right mistake:  1258 , error:  0.433430045132
feature:  grade.B , left mistake:  12725 , right mistake:  4343 , error:  0.458521384053
feature:  grade.C , left mistake:  13562 , right mistake:  4498 , error:  0.485170857511
feature:  grade.D , left mistake:  14400 , right mistake:  2683 , error:  0.458924349882
feature:  grade.E , left mistake:  16168 , right mistake:  1101 , error:  0.463921126155
feature:  grade.F , left mistake:  17226 , right mistake:  462 , error:  0.475177304965
feature:  grade.G , left mistake:  18149 , right mistake:  109 , error:  0.490490006447
feature:  term. 36 months , left mistake:  3221 , right mistake:  12474 , error:  0.421636578551
feature:  term. 60 months , left mistake:  12474 , right mistake:  3221 , error:  0.421636578551
feature:  home_ownership.MORTGAGE , left mistake:  9383 , right mistake:  8013 , error:  0.467332903503
feature:  home_ownership.OTHER , left mistake:  18443 , right mistake:  28 , error:  0.496212121212
feature:  home_ownership.OWN , left mistake:  16916 , right mistake:  1515 , error:  0.495137545669
feature:  home_ownership.RENT , left mistake:  9606 , right mistake:  7840 , error:  0.468676122931
feature:  emp_length.1 year , left mistake:  17190 , right mistake:  1286 , error:  0.496346443155
feature:  emp_length.10+ years , left mistake:  13417 , right mistake:  5059 , error:  0.496346443155
feature:  emp_length.2 years , left mistake:  16766 , right mistake:  1710 , error:  0.496346443155
feature:  emp_length.3 years , left mistake:  16967 , right mistake:  1509 , error:  0.496346443155
feature:  emp_length.4 years , left mistake:  17258 , right mistake:  1218 , error:  0.496346443155
feature:  emp_length.5 years , left mistake:  17041 , right mistake:  1435 , error:  0.496346443155
feature:  emp_length.6 years , left mistake:  17285 , right mistake:  1128 , error:  0.494653986675
feature:  emp_length.7 years , left mistake:  17427 , right mistake:  979 , error:  0.494465935955
feature:  emp_length.8 years , left mistake:  17665 , right mistake:  806 , error:  0.496212121212
feature:  emp_length.9 years , left mistake:  17811 , right mistake:  665 , error:  0.496346443155
feature:  emp_length.&lt; 1 year , left mistake:  16818 , right mistake:  1658 , error:  0.496346443155
feature:  emp_length.n/a , left mistake:  17591 , right mistake:  558 , error:  0.487561788094
Best error:  0.421636578551
Test passed!
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Building-the-tree">Building the tree<a class="anchor-link" href="#Building-the-tree">&#182;</a></h2><p>With the above functions implemented correctly, we are now ready to build our decision tree. Each node in the decision tree is represented as a dictionary which contains the following keys and possible values:</p>

<pre><code>{ 
   'is_leaf'            : True/False.
   'prediction'         : Prediction at the leaf node.
   'left'               : (dictionary corresponding to the left tree).
   'right'              : (dictionary corresponding to the right tree).
   'splitting_feature'  : The feature that this node splits on.
}

</code></pre>
<p>First, we will write a function that creates a leaf node given a set of target values. Fill in the places where you find <code>## YOUR CODE HERE</code>. There are <strong>three</strong> places in this function for you to fill in.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[72]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="k">def</span> <span class="nf">create_leaf</span><span class="p">(</span><span class="n">target_values</span><span class="p">):</span>
    
    <span class="c1"># Create a leaf node</span>
    <span class="n">leaf</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;splitting_feature&#39;</span> <span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
            <span class="s1">&#39;left&#39;</span> <span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
            <span class="s1">&#39;right&#39;</span> <span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
            <span class="s1">&#39;is_leaf&#39;</span><span class="p">:</span>  <span class="bp">True</span>   <span class="p">}</span>   <span class="c1">## YOUR CODE HERE</span>
    
    <span class="c1"># Count the number of data points that are +1 and -1 in this node.</span>
    <span class="n">num_ones</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">target_values</span><span class="p">[</span><span class="n">target_values</span> <span class="o">==</span> <span class="o">+</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">num_minus_ones</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">target_values</span><span class="p">[</span><span class="n">target_values</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    
    <span class="c1"># For the leaf node, set the prediction to be the majority class.</span>
    <span class="c1"># Store the predicted class (1 or -1) in leaf[&#39;prediction&#39;]</span>
    <span class="k">if</span> <span class="n">num_ones</span> <span class="o">&gt;</span> <span class="n">num_minus_ones</span><span class="p">:</span>
        <span class="n">leaf</span><span class="p">[</span><span class="s1">&#39;prediction&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>          <span class="c1">## YOUR CODE HERE</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">leaf</span><span class="p">[</span><span class="s1">&#39;prediction&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="o">-</span><span class="mi">1</span>        <span class="c1">## YOUR CODE HERE</span>
        
    <span class="c1"># Return the leaf node        </span>
    <span class="k">return</span> <span class="n">leaf</span> 
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We have provided a function that learns the decision tree recursively and implements 3 stopping conditions:</p>
<ol>
<li><strong>Stopping condition 1:</strong> All data points in a node are from the same class.</li>
<li><strong>Stopping condition 2:</strong> No more features to split on.</li>
<li><strong>Additional stopping condition:</strong> In addition to the above two stopping conditions covered in lecture, in this assignment we will also consider a stopping condition based on the <strong>max_depth</strong> of the tree. By not letting the tree grow too deep, we will save computational effort in the learning process. </li>
</ol>
<p>Now, we will write down the skeleton of the learning algorithm. Fill in the places where you find <code>## YOUR CODE HERE</code>. There are <strong>seven</strong> places in this function for you to fill in.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[73]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="k">def</span> <span class="nf">decision_tree_create</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">current_depth</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">max_depth</span> <span class="o">=</span> <span class="mi">10</span><span class="p">):</span>
    <span class="n">remaining_features</span> <span class="o">=</span> <span class="n">features</span><span class="p">[:]</span> <span class="c1"># Make a copy of the features.</span>
    
    <span class="n">target_values</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">target</span><span class="p">]</span>
    <span class="k">print</span> <span class="s2">&quot;--------------------------------------------------------------------&quot;</span>
    <span class="k">print</span> <span class="s2">&quot;Subtree, depth = </span><span class="si">%s</span><span class="s2"> (</span><span class="si">%s</span><span class="s2"> data points).&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">current_depth</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">target_values</span><span class="p">))</span>
    

    <span class="c1"># Stopping condition 1</span>
    <span class="c1"># (Check if there are mistakes at current node.</span>
    <span class="c1"># Recall you wrote a function intermediate_node_num_mistakes to compute this.)</span>
    <span class="k">if</span> <span class="n">intermediate_node_num_mistakes</span><span class="p">(</span><span class="n">target_values</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1">## YOUR CODE HERE</span>
        <span class="k">print</span> <span class="s2">&quot;Stopping condition 1 reached.&quot;</span>     
        <span class="c1"># If not mistakes at current node, make current node a leaf node</span>
        <span class="k">return</span> <span class="n">create_leaf</span><span class="p">(</span><span class="n">target_values</span><span class="p">)</span>
    
    <span class="c1"># Stopping condition 2 (check if there are remaining features to consider splitting on)</span>
    <span class="k">if</span> <span class="n">remaining_features</span> <span class="o">==</span> <span class="p">[]:</span>   <span class="c1">## YOUR CODE HERE</span>
        <span class="k">print</span> <span class="s2">&quot;Stopping condition 2 reached.&quot;</span>    
        <span class="c1"># If there are no remaining features to consider, make current node a leaf node</span>
        <span class="k">return</span> <span class="n">create_leaf</span><span class="p">(</span><span class="n">target_values</span><span class="p">)</span>    
    
    <span class="c1"># Additional stopping condition (limit tree depth)</span>
    <span class="k">if</span> <span class="n">current_depth</span> <span class="o">&gt;=</span> <span class="n">max_depth</span><span class="p">:</span>  <span class="c1">## YOUR CODE HERE</span>
        <span class="k">print</span> <span class="s2">&quot;Reached maximum depth. Stopping for now.&quot;</span>
        <span class="c1"># If the max tree depth has been reached, make current node a leaf node</span>
        <span class="k">return</span> <span class="n">create_leaf</span><span class="p">(</span><span class="n">target_values</span><span class="p">)</span>

    <span class="c1"># Find the best splitting feature (recall the function best_splitting_feature implemented above)</span>
    <span class="c1">## YOUR CODE HERE</span>
    
    <span class="n">splitting_feature</span> <span class="o">=</span> <span class="n">best_splitting_feature</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>

    
    <span class="c1"># Split on the best feature that we found. </span>
    <span class="n">left_split</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="n">splitting_feature</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">right_split</span> <span class="o">=</span>      <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="n">splitting_feature</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span> <span class="c1">## YOUR CODE HERE</span>
    <span class="n">remaining_features</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">splitting_feature</span><span class="p">)</span>
    <span class="k">print</span> <span class="s2">&quot;Split on feature </span><span class="si">%s</span><span class="s2">. (</span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span>\
                      <span class="n">splitting_feature</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">left_split</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">right_split</span><span class="p">))</span>
    
    <span class="c1"># Create a leaf node if the split is &quot;perfect&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">left_split</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
        <span class="k">print</span> <span class="s2">&quot;Creating leaf node.&quot;</span>
        <span class="k">return</span> <span class="n">create_leaf</span><span class="p">(</span><span class="n">left_split</span><span class="p">[</span><span class="n">target</span><span class="p">])</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">right_split</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
        <span class="k">print</span> <span class="s2">&quot;Creating leaf node.&quot;</span>
        <span class="c1">## YOUR CODE HERE</span>
        
        <span class="n">create_leaf</span><span class="p">(</span><span class="n">right_split</span><span class="p">[</span><span class="n">target</span><span class="p">])</span>

        
    <span class="c1"># Repeat (recurse) on left and right subtrees</span>
    <span class="n">left_tree</span> <span class="o">=</span> <span class="n">decision_tree_create</span><span class="p">(</span><span class="n">left_split</span><span class="p">,</span> <span class="n">remaining_features</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">current_depth</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">max_depth</span><span class="p">)</span>        
    <span class="c1">## YOUR CODE HERE</span>
    <span class="n">right_tree</span> <span class="o">=</span> <span class="n">decision_tree_create</span><span class="p">(</span><span class="n">right_split</span><span class="p">,</span> <span class="n">remaining_features</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">current_depth</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">max_depth</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;is_leaf&#39;</span>          <span class="p">:</span> <span class="bp">False</span><span class="p">,</span> 
            <span class="s1">&#39;prediction&#39;</span>       <span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
            <span class="s1">&#39;splitting_feature&#39;</span><span class="p">:</span> <span class="n">splitting_feature</span><span class="p">,</span>
            <span class="s1">&#39;left&#39;</span>             <span class="p">:</span> <span class="n">left_tree</span><span class="p">,</span> 
            <span class="s1">&#39;right&#39;</span>            <span class="p">:</span> <span class="n">right_tree</span><span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here is a recursive function to count the nodes in your tree:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[74]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="k">def</span> <span class="nf">count_nodes</span><span class="p">(</span><span class="n">tree</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">tree</span><span class="p">[</span><span class="s1">&#39;is_leaf&#39;</span><span class="p">]:</span>
        <span class="k">return</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">count_nodes</span><span class="p">(</span><span class="n">tree</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">])</span> <span class="o">+</span> <span class="n">count_nodes</span><span class="p">(</span><span class="n">tree</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Run the following test code to check your implementation. Make sure you get <strong>'Test passed'</strong> before proceeding.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[77]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">small_data_decision_tree</span> <span class="o">=</span> <span class="n">decision_tree_create</span><span class="p">(</span><span class="n">train_data</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="s1">&#39;safe_loans&#39;</span><span class="p">,</span> <span class="n">max_depth</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
<span class="k">if</span> <span class="n">count_nodes</span><span class="p">(</span><span class="n">small_data_decision_tree</span><span class="p">)</span> <span class="o">==</span> <span class="mi">13</span><span class="p">:</span>
    <span class="k">print</span> <span class="s1">&#39;Test passed!&#39;</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">print</span> <span class="s1">&#39;Test failed... try again!&#39;</span>
    <span class="k">print</span> <span class="s1">&#39;Number of nodes found                :&#39;</span><span class="p">,</span> <span class="n">count_nodes</span><span class="p">(</span><span class="n">small_data_decision_tree</span><span class="p">)</span>
    <span class="k">print</span> <span class="s1">&#39;Number of nodes that should be there : 13&#39;</span> 
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>--------------------------------------------------------------------
Subtree, depth = 0 (37224 data points).
Split on feature term. 36 months. (9223, 28001)
--------------------------------------------------------------------
Subtree, depth = 1 (9223 data points).
Split on feature grade.A. (9122, 101)
--------------------------------------------------------------------
Subtree, depth = 2 (9122 data points).
Split on feature grade.B. (8074, 1048)
--------------------------------------------------------------------
Subtree, depth = 3 (8074 data points).
Reached maximum depth. Stopping for now.
--------------------------------------------------------------------
Subtree, depth = 3 (1048 data points).
Reached maximum depth. Stopping for now.
--------------------------------------------------------------------
Subtree, depth = 2 (101 data points).
Split on feature emp_length.n/a. (96, 5)
--------------------------------------------------------------------
Subtree, depth = 3 (96 data points).
Reached maximum depth. Stopping for now.
--------------------------------------------------------------------
Subtree, depth = 3 (5 data points).
Reached maximum depth. Stopping for now.
--------------------------------------------------------------------
Subtree, depth = 1 (28001 data points).
Split on feature grade.D. (23300, 4701)
--------------------------------------------------------------------
Subtree, depth = 2 (23300 data points).
Split on feature grade.E. (22024, 1276)
--------------------------------------------------------------------
Subtree, depth = 3 (22024 data points).
Reached maximum depth. Stopping for now.
--------------------------------------------------------------------
Subtree, depth = 3 (1276 data points).
Reached maximum depth. Stopping for now.
--------------------------------------------------------------------
Subtree, depth = 2 (4701 data points).
Split on feature grade.A. (4701, 0)
Creating leaf node.
Test passed!
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Build-the-tree!">Build the tree!<a class="anchor-link" href="#Build-the-tree!">&#182;</a></h2><p>Now that all the tests are passing, we will train a tree model on the <strong>train_data</strong>. Limit the depth to 6 (<strong>max_depth = 6</strong>) to make sure the algorithm doesn't run for too long. Call this tree <strong>my_decision_tree</strong>.</p>
<p><strong>Warning</strong>: This code block may take 1-2 minutes to learn.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[78]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="c1"># Make sure to cap the depth at 6 by using max_depth = 6</span>
<span class="n">my_decision_tree</span> <span class="o">=</span> <span class="n">decision_tree_create</span><span class="p">(</span><span class="n">train_data</span><span class="p">,</span> <span class="n">features</span><span class="p">,</span> <span class="s1">&#39;safe_loans&#39;</span><span class="p">,</span> <span class="n">max_depth</span> <span class="o">=</span> <span class="mi">6</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>--------------------------------------------------------------------
Subtree, depth = 0 (37224 data points).
Split on feature term. 36 months. (9223, 28001)
--------------------------------------------------------------------
Subtree, depth = 1 (9223 data points).
Split on feature grade.A. (9122, 101)
--------------------------------------------------------------------
Subtree, depth = 2 (9122 data points).
Split on feature grade.B. (8074, 1048)
--------------------------------------------------------------------
Subtree, depth = 3 (8074 data points).
Split on feature grade.C. (5884, 2190)
--------------------------------------------------------------------
Subtree, depth = 4 (5884 data points).
Split on feature grade.D. (3826, 2058)
--------------------------------------------------------------------
Subtree, depth = 5 (3826 data points).
Split on feature grade.E. (1693, 2133)
--------------------------------------------------------------------
Subtree, depth = 6 (1693 data points).
Reached maximum depth. Stopping for now.
--------------------------------------------------------------------
Subtree, depth = 6 (2133 data points).
Reached maximum depth. Stopping for now.
--------------------------------------------------------------------
Subtree, depth = 5 (2058 data points).
Split on feature grade.E. (2058, 0)
Creating leaf node.
--------------------------------------------------------------------
Subtree, depth = 4 (2190 data points).
Split on feature grade.D. (2190, 0)
Creating leaf node.
--------------------------------------------------------------------
Subtree, depth = 3 (1048 data points).
Split on feature emp_length.5 years. (969, 79)
--------------------------------------------------------------------
Subtree, depth = 4 (969 data points).
Split on feature grade.C. (969, 0)
Creating leaf node.
--------------------------------------------------------------------
Subtree, depth = 4 (79 data points).
Split on feature home_ownership.MORTGAGE. (34, 45)
--------------------------------------------------------------------
Subtree, depth = 5 (34 data points).
Split on feature grade.C. (34, 0)
Creating leaf node.
--------------------------------------------------------------------
Subtree, depth = 5 (45 data points).
Split on feature grade.C. (45, 0)
Creating leaf node.
--------------------------------------------------------------------
Subtree, depth = 2 (101 data points).
Split on feature emp_length.n/a. (96, 5)
--------------------------------------------------------------------
Subtree, depth = 3 (96 data points).
Split on feature emp_length.&lt; 1 year. (85, 11)
--------------------------------------------------------------------
Subtree, depth = 4 (85 data points).
Split on feature grade.B. (85, 0)
Creating leaf node.
--------------------------------------------------------------------
Subtree, depth = 4 (11 data points).
Split on feature grade.B. (11, 0)
Creating leaf node.
--------------------------------------------------------------------
Subtree, depth = 3 (5 data points).
Split on feature grade.B. (5, 0)
Creating leaf node.
--------------------------------------------------------------------
Subtree, depth = 1 (28001 data points).
Split on feature grade.D. (23300, 4701)
--------------------------------------------------------------------
Subtree, depth = 2 (23300 data points).
Split on feature grade.E. (22024, 1276)
--------------------------------------------------------------------
Subtree, depth = 3 (22024 data points).
Split on feature grade.F. (21666, 358)
--------------------------------------------------------------------
Subtree, depth = 4 (21666 data points).
Split on feature emp_length.n/a. (20734, 932)
--------------------------------------------------------------------
Subtree, depth = 5 (20734 data points).
Split on feature grade.G. (20638, 96)
--------------------------------------------------------------------
Subtree, depth = 6 (20638 data points).
Reached maximum depth. Stopping for now.
--------------------------------------------------------------------
Subtree, depth = 6 (96 data points).
Reached maximum depth. Stopping for now.
--------------------------------------------------------------------
Subtree, depth = 5 (932 data points).
Split on feature grade.A. (702, 230)
--------------------------------------------------------------------
Subtree, depth = 6 (702 data points).
Reached maximum depth. Stopping for now.
--------------------------------------------------------------------
Subtree, depth = 6 (230 data points).
Reached maximum depth. Stopping for now.
--------------------------------------------------------------------
Subtree, depth = 4 (358 data points).
Split on feature emp_length.8 years. (347, 11)
--------------------------------------------------------------------
Subtree, depth = 5 (347 data points).
Split on feature grade.A. (347, 0)
Creating leaf node.
--------------------------------------------------------------------
Subtree, depth = 5 (11 data points).
Split on feature home_ownership.OWN. (9, 2)
--------------------------------------------------------------------
Subtree, depth = 6 (9 data points).
Reached maximum depth. Stopping for now.
--------------------------------------------------------------------
Subtree, depth = 6 (2 data points).
Stopping condition 1 reached.
--------------------------------------------------------------------
Subtree, depth = 3 (1276 data points).
Split on feature grade.A. (1276, 0)
Creating leaf node.
--------------------------------------------------------------------
Subtree, depth = 2 (4701 data points).
Split on feature grade.A. (4701, 0)
Creating leaf node.
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Making-predictions-with-a-decision-tree">Making predictions with a decision tree<a class="anchor-link" href="#Making-predictions-with-a-decision-tree">&#182;</a></h2><p>As discussed in the lecture, we can make predictions from the decision tree with a simple recursive function. Below, we call this function <code>classify</code>, which takes in a learned <code>tree</code> and a test point <code>x</code> to classify.  We include an option <code>annotate</code> that describes the prediction path when set to <code>True</code>.</p>
<p>Fill in the places where you find <code>## YOUR CODE HERE</code>. There is <strong>one</strong> place in this function for you to fill in.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[79]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="k">def</span> <span class="nf">classify</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">annotate</span> <span class="o">=</span> <span class="bp">False</span><span class="p">):</span>   
    <span class="c1"># if the node is a leaf node.</span>
    <span class="k">if</span> <span class="n">tree</span><span class="p">[</span><span class="s1">&#39;is_leaf&#39;</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">annotate</span><span class="p">:</span> 
            <span class="k">print</span> <span class="s2">&quot;At leaf, predicting </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">tree</span><span class="p">[</span><span class="s1">&#39;prediction&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">tree</span><span class="p">[</span><span class="s1">&#39;prediction&#39;</span><span class="p">]</span> 
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># split on feature.</span>
        <span class="n">split_feature_value</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">tree</span><span class="p">[</span><span class="s1">&#39;splitting_feature&#39;</span><span class="p">]]</span>
        <span class="k">if</span> <span class="n">annotate</span><span class="p">:</span> 
            <span class="k">print</span> <span class="s2">&quot;Split on </span><span class="si">%s</span><span class="s2"> = </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">tree</span><span class="p">[</span><span class="s1">&#39;splitting_feature&#39;</span><span class="p">],</span> <span class="n">split_feature_value</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">split_feature_value</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">classify</span><span class="p">(</span><span class="n">tree</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">],</span> <span class="n">x</span><span class="p">,</span> <span class="n">annotate</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
               <span class="c1">### YOUR CODE HERE</span>
            <span class="k">return</span> <span class="n">classify</span><span class="p">(</span><span class="n">tree</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">],</span> <span class="n">x</span><span class="p">,</span> <span class="n">annotate</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now, let's consider the first example of the test set and see what <code>my_decision_tree</code> model predicts for this data point.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[80]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">test_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[80]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>{&#39;emp_length.1 year&#39;: 0L,
 &#39;emp_length.10+ years&#39;: 0L,
 &#39;emp_length.2 years&#39;: 1L,
 &#39;emp_length.3 years&#39;: 0L,
 &#39;emp_length.4 years&#39;: 0L,
 &#39;emp_length.5 years&#39;: 0L,
 &#39;emp_length.6 years&#39;: 0L,
 &#39;emp_length.7 years&#39;: 0L,
 &#39;emp_length.8 years&#39;: 0L,
 &#39;emp_length.9 years&#39;: 0L,
 &#39;emp_length.&lt; 1 year&#39;: 0L,
 &#39;emp_length.n/a&#39;: 0L,
 &#39;grade.A&#39;: 0L,
 &#39;grade.B&#39;: 0L,
 &#39;grade.C&#39;: 0L,
 &#39;grade.D&#39;: 1L,
 &#39;grade.E&#39;: 0L,
 &#39;grade.F&#39;: 0L,
 &#39;grade.G&#39;: 0L,
 &#39;home_ownership.MORTGAGE&#39;: 0L,
 &#39;home_ownership.OTHER&#39;: 0L,
 &#39;home_ownership.OWN&#39;: 0L,
 &#39;home_ownership.RENT&#39;: 1L,
 &#39;safe_loans&#39;: -1L,
 &#39;term. 36 months&#39;: 0L,
 &#39;term. 60 months&#39;: 1L}</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[82]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="k">print</span> <span class="s1">&#39;Predicted class: </span><span class="si">%s</span><span class="s1"> &#39;</span> <span class="o">%</span> <span class="n">classify</span><span class="p">(</span><span class="n">my_decision_tree</span><span class="p">,</span> <span class="n">test_data</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">annotate</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Split on term. 36 months = 0
Split on grade.A = 0
Split on grade.B = 0
Split on grade.C = 0
Split on grade.D = 1
At leaf, predicting -1
Predicted class: -1 
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's add some annotations to our prediction to see what the prediction path was that lead to this predicted class:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[83]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">classify</span><span class="p">(</span><span class="n">my_decision_tree</span><span class="p">,</span> <span class="n">test_data</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">annotate</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Split on term. 36 months = 0
Split on grade.A = 0
Split on grade.B = 0
Split on grade.C = 0
Split on grade.D = 1
At leaf, predicting -1
</pre>
</div>
</div>

<div class="output_area">

    <div class="prompt output_prompt">Out[83]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>-1</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong> Question:</strong> What was the feature that <strong>my_decision_tree</strong> first split on while making the prediction for test_data[0]?</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong> Question:</strong> What was the first feature that lead to a right split of test_data[0]?</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong> Question:</strong> What was the last feature split on before reaching a leaf node for test_data[0]?</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Evaluating-your-decision-tree">Evaluating your decision tree<a class="anchor-link" href="#Evaluating-your-decision-tree">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now, we will write a function to evaluate a decision tree by computing the classification error of the tree on the given dataset.</p>
<p>Again, recall that the <strong>classification error</strong> is defined as follows:
$$
\mbox{classification error} = \frac{\mbox{# mistakes}}{\mbox{# total examples}}
$$</p>
<p>Now, write a function called <code>evaluate_classification_error</code> that takes in as input:</p>
<ol>
<li><code>tree</code> (as described above)</li>
<li><code>data</code> (an SFrame)</li>
<li><code>target</code> (a string - the name of the target/label column)</li>
</ol>
<p>This function should calculate a prediction (class label) for each row in <code>data</code> using the decision <code>tree</code> and return the classification error computed using the above formula. Fill in the places where you find <code>## YOUR CODE HERE</code>. There is <strong>one</strong> place in this function for you to fill in.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[84]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="k">def</span> <span class="nf">evaluate_classification_error</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
    <span class="c1"># Apply the classify(tree, x) to each row in your data</span>
    <span class="n">prediction</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">classify</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>
    
    <span class="c1"># Once you&#39;ve made the predictions, calculate the classification error and return it</span>
    <span class="c1">## YOUR CODE HERE</span>
    
    <span class="n">num_of_mistakes</span> <span class="o">=</span> <span class="p">(</span><span class="n">prediction</span> <span class="o">!=</span> <span class="n">data</span><span class="p">[</span><span class="n">target</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">num_of_mistakes</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now, let's use this function to evaluate the classification error on the test set.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[87]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">evaluate_classification_error</span><span class="p">(</span><span class="n">my_decision_tree</span><span class="p">,</span> <span class="n">test_data</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[87]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>0.3837785437311504</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Quiz Question:</strong> Rounded to 2nd decimal point, what is the classification error of <strong>my_decision_tree</strong> on the <strong>test_data</strong>?</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Printing-out-a-decision-stump">Printing out a decision stump<a class="anchor-link" href="#Printing-out-a-decision-stump">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As discussed in the lecture, we can print out a single decision stump (printing out the entire tree is left as an exercise to the curious reader).</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[88]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="k">def</span> <span class="nf">print_stump</span><span class="p">(</span><span class="n">tree</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;root&#39;</span><span class="p">):</span>
    <span class="n">split_name</span> <span class="o">=</span> <span class="n">tree</span><span class="p">[</span><span class="s1">&#39;splitting_feature&#39;</span><span class="p">]</span> <span class="c1"># split_name is something like &#39;term. 36 months&#39;</span>
    <span class="k">if</span> <span class="n">split_name</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">print</span> <span class="s2">&quot;(leaf, label: </span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="n">tree</span><span class="p">[</span><span class="s1">&#39;prediction&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">None</span>
    <span class="n">split_feature</span><span class="p">,</span> <span class="n">split_value</span> <span class="o">=</span> <span class="n">split_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
    <span class="k">print</span> <span class="s1">&#39;                       </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">name</span>
    <span class="k">print</span> <span class="s1">&#39;         |---------------|----------------|&#39;</span>
    <span class="k">print</span> <span class="s1">&#39;         |                                |&#39;</span>
    <span class="k">print</span> <span class="s1">&#39;         |                                |&#39;</span>
    <span class="k">print</span> <span class="s1">&#39;         |                                |&#39;</span>
    <span class="k">print</span> <span class="s1">&#39;  [{0} == 0]               [{0} == 1]    &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">split_name</span><span class="p">)</span>
    <span class="k">print</span> <span class="s1">&#39;         |                                |&#39;</span>
    <span class="k">print</span> <span class="s1">&#39;         |                                |&#39;</span>
    <span class="k">print</span> <span class="s1">&#39;         |                                |&#39;</span>
    <span class="k">print</span> <span class="s1">&#39;    (</span><span class="si">%s</span><span class="s1">)                         (</span><span class="si">%s</span><span class="s1">)&#39;</span> \
        <span class="o">%</span> <span class="p">((</span><span class="s1">&#39;leaf, label: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">tree</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">][</span><span class="s1">&#39;prediction&#39;</span><span class="p">])</span> <span class="k">if</span> <span class="n">tree</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">][</span><span class="s1">&#39;is_leaf&#39;</span><span class="p">]</span> <span class="k">else</span> <span class="s1">&#39;subtree&#39;</span><span class="p">),</span>
           <span class="p">(</span><span class="s1">&#39;leaf, label: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">tree</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">][</span><span class="s1">&#39;prediction&#39;</span><span class="p">])</span> <span class="k">if</span> <span class="n">tree</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">][</span><span class="s1">&#39;is_leaf&#39;</span><span class="p">]</span> <span class="k">else</span> <span class="s1">&#39;subtree&#39;</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[89]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">print_stump</span><span class="p">(</span><span class="n">my_decision_tree</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>                       root
         |---------------|----------------|
         |                                |
         |                                |
         |                                |
  [term. 36 months == 0]               [term. 36 months == 1]    
         |                                |
         |                                |
         |                                |
    (subtree)                         (subtree)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Quiz Question:</strong> What is the feature that is used for the split at the root node?</p>
<h3 id="Exploring-the-intermediate-left-subtree">Exploring the intermediate left subtree<a class="anchor-link" href="#Exploring-the-intermediate-left-subtree">&#182;</a></h3><p>The tree is a recursive dictionary, so we do have access to all the nodes! We can use</p>
<ul>
<li><code>my_decision_tree['left']</code> to go left</li>
<li><code>my_decision_tree['right']</code> to go right</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[90]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">print_stump</span><span class="p">(</span><span class="n">my_decision_tree</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">],</span> <span class="n">my_decision_tree</span><span class="p">[</span><span class="s1">&#39;splitting_feature&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>                       term. 36 months
         |---------------|----------------|
         |                                |
         |                                |
         |                                |
  [grade.A == 0]               [grade.A == 1]    
         |                                |
         |                                |
         |                                |
    (subtree)                         (subtree)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Exploring-the-left-subtree-of-the-left-subtree">Exploring the left subtree of the left subtree<a class="anchor-link" href="#Exploring-the-left-subtree-of-the-left-subtree">&#182;</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[91]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">print_stump</span><span class="p">(</span><span class="n">my_decision_tree</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">][</span><span class="s1">&#39;left&#39;</span><span class="p">],</span> <span class="n">my_decision_tree</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">][</span><span class="s1">&#39;splitting_feature&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>                       grade.A
         |---------------|----------------|
         |                                |
         |                                |
         |                                |
  [grade.B == 0]               [grade.B == 1]    
         |                                |
         |                                |
         |                                |
    (subtree)                         (subtree)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Question:</strong> What is the path of the <strong>first 3 feature splits</strong> considered along the <strong>left-most</strong> branch of <strong>my_decision_tree</strong>?</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Question:</strong> What is the path of the <strong>first 3 feature splits</strong> considered along the <strong>right-most</strong> branch of <strong>my_decision_tree</strong>?</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[92]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">print_stump</span><span class="p">(</span><span class="n">my_decision_tree</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">],</span> <span class="n">my_decision_tree</span><span class="p">[</span><span class="s1">&#39;splitting_feature&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>                       term. 36 months
         |---------------|----------------|
         |                                |
         |                                |
         |                                |
  [grade.D == 0]               [grade.D == 1]    
         |                                |
         |                                |
         |                                |
    (subtree)                         (leaf, label: -1)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[93]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">print_stump</span><span class="p">(</span><span class="n">my_decision_tree</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">][</span><span class="s1">&#39;right&#39;</span><span class="p">],</span> <span class="n">my_decision_tree</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">][</span><span class="s1">&#39;splitting_feature&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>(leaf, label: -1)
</pre>
</div>
</div>

</div>
</div>

</div>
 


<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: 'center'," +
        "    displayIndent: '0em'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['$','$'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        " linebreaks: { automatic: true, width: '95% container' }, " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
        "    } " +
        "}); ";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>

            </section>

            <section class="post-info">
                <div class="post-share">
                    <a class="twitter" href="https://twitter.com/share?text=Decision Trees&amp;url=https://arslan-san.github.io/implement-decision-tree-from-scratch.html" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                    <i class="ic ic-twitter"></i><span class="hidden">Twitter</span>
                    </a>
                    <a class="facebook" href="https://www.facebook.com/sharer/sharer.php?u=https://arslan-san.github.io/implement-decision-tree-from-scratch.html" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                    <i class="ic ic-facebook"></i><span class="hidden">Facebook</span>
                    </a>
                    <a class="googleplus" href="https://plus.google.com/share?url=https://arslan-san.github.io/implement-decision-tree-from-scratch.html" onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
                    <i class="ic ic-googleplus"></i><span class="hidden">Google+</span>
                    </a>
                    <div class="clear"></div>
                </div>

                <aside class="post-tags">
<a href="https://arslan-san.github.io/tag/python-linear-classifier-decision-tree.html">python linear-classifier decision-tree</a>                </aside>

                <div class="clear"></div>

                <aside class="post-author">
                        <figure class="post-author-avatar">
                            <img src="theme\imagesuthor.png" alt="Arslan" />
                        </figure>
                    <div class="post-author-bio">
                        <h4 class="post-author-name"><a href="https://arslan-san.github.io/author/arslan.html">Arslan</a></h4>
                            <p class="post-author-about">This is the place for a small biography with max 200 characters. Well, now 100 are left. Cool, hugh?</p>
                            <span class="post-author-location"><i class="ic ic-location"></i> Pakistan</span>
                            <span class="post-author-website"><a href="http://arslan-san.github.io"><i class="ic ic-link"></i> Website</a></span>
                    </div>
                    <div class="clear"></div>
                </aside>
 

                </section>

                <script type="text/javascript">
                    var disqus = 'arslanblog';
                    var disqus_shortname = 'arslanblog';
                    var disqus_identifier = '/implement-decision-tree-from-scratch.html';
                    var disqus_url = 'https://arslan-san.github.io/implement-decision-tree-from-scratch.html';
                </script>
                <noscript>Please enable JavaScript to view the comments.</noscript>                  
                <section class="post-comments">
                        <a id="show-disqus" class="post-comments-activate" data-disqus-identifier="/implement-decision-tree-from-scratch.html" >Show Comments</a>
                    <div id="disqus_thread"></div>                  
                </section>

                <aside class="post-nav">
                    <div class="clear"></div>
                </aside>

            </div>
        </article>
    </main>
      <!-- TODO : Body class -->
    <div id="body-class" style="display: none;" class=""></div>
  
    <footer id="footer">
      <div class="inner">
        <section class="credits">
          <span class="credits-theme">Theme <a href="https://github.com/arulrajnet/attila" rel="nofollow">Attila</a></span>
          <span class="credits-software">Published with <a href="https://github.com/getpelican/pelican" rel="nofollow">Pelican</a></span>
        </section>
      </div>
    </footer>
  </section>

  <script type="text/javascript" src="https://arslan-san.github.io/theme/js/script.js"></script>
  
<script type="text/javascript">
    var disqus_shortname = 'arslanblog';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
</body>
</html>